
# Technical Report CA01
Technical report do CA01 no âmbito da UC de COGSI realizado por:

1. David Ferreira - 1240444
2. Rafael Gomes - 1211426
3. Nuno Cunha - 1211689

## Issue 2 - Add veterinarian's Professional Registration Number field
### 1º Passo - Obter a versão mais recente do projeto
Para se obter a ultima versão do projeto utilizou-se o comando ***git pull***, obtendo o seguinte resultado.

    nacunha@cogsi:/mnt/hgfs/Shared/cogsi2526-1240444-1211426-1211689$ git pull
    Already up to date.
    nacunha@cogsi:/mnt/hgfs/Shared/cogsi2526-1240444-1211426-1211689$ 

Obtendo a última versão do projeto, evita-se que alterações feitas na implementação do *use case* tenham conflitos com possíveis alterações já implementadas.

### 2º Passo - Fazer as alterações ao código
Neste *issue*, para se adicionar o campo de ***Professional Registration Number*** foi necessário fazer alterações às seguintes classe:
  1. ***Vet.java*** - Classe do domínio. onde estão estabelecidas regras de negócio e dados referentes aos veterinários    

    @Column(name = "professional_number")
    @NotEmpty
    @Digits(fraction = 0, integer = 10)
    private String professionalNumber;

    public String getProfessionalNumber() {
        return this.professionalNumber;
    }

    public void setProfessionalNumber(String newNumber) {
        this.professionalNumber = newNumber;
    }

Adicionada a coluna à tabela e os devidos métodos *Getter* e *Setter* para o novo atributo. De notar, que estão apenas representadas, neste *Technical Report*, as diferenças implementadas.

  2. ***vetList.jsp*** - tipo de ficheiro usado para construir páginas *Web* em aplicações desenvolvidas em Java.

    <div class="row">
      <table id="vetsTable" class="table table-striped" aria-describedby="veterinarians">
          <thead>
          <tr>
              <th scope="col">Name</th>
              <th scope="col">Professional Registration Number</th>
              <th scope="col">Specialties</th>
          </tr>
          </thead>
          <tbody>
          <c:forEach items="${vets.vetList}" var="vet">
              <tr>
                  <td>
                      <c:out value="${vet.firstName} ${vet.lastName}"/>
                  </td>
                  <td>
                      <c:out value="${vet.professionalNumber}"/>
                  </td>
                  <td>
                      <c:forEach var="specialty" items="${vet.specialties}">
                          <c:out value="${specialty.name} "/>
                      </c:forEach>
                      <c:if test="${vet.nrOfSpecialties == 0}">none</c:if>
                  </td>
              </tr>
          </c:forEach>
          </tbody>
      </table>
    </div>

Adicionada a vizualização dos valores da coluna, na página *web*, entre o nome e as especialidades dos veterinários.

Para além das classes, foi alterada a tabela na base de dados, adicionando o campo para o ***Professional Registration Number*** e adicionados valores aos campos nos dados de teste.

    CREATE TABLE vets (
      id         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      first_name VARCHAR(30),
      last_name  VARCHAR(30),
      professional_number VARCHAR(30) 
    );
    CREATE INDEX vets_last_name ON vets (last_name);

Como é possível ver, acima, o campo "*professional_number*" é adicionado e em seguida, podemos ver os dados de teste adicionados a mesma tabela.

    INSERT INTO vets VALUES (default, 'James', 'Carter','1');
    INSERT INTO vets VALUES (default, 'Helen', 'Leary','2');
    INSERT INTO vets VALUES (default, 'Linda', 'Douglas','3');
    INSERT INTO vets VALUES (default, 'Rafael', 'Ortega','4');
    INSERT INTO vets VALUES (default, 'Henry', 'Stevens','5');
    INSERT INTO vets VALUES (default, 'Sharon', 'Jenkins','6');

### 3º Passo - Fazer *commit* das alterações

#### 3.1. Verificar diferenças nos ficheiros

Antes do *commit*, podemos verificar se realmente as mudanças nos ficheiros realmente são visíveis pelo Git, utilizandos os comandos: **git status** para validar os ficheiros alterados e o comando **git diff** para verificar as mudanças efetuadas em cada ficheiro.

*Output* do comando **git status**:

    nacunha@cogsi:/mnt/hgfs/Shared/cogsi2526-1240444-1211426-1211689$ git status
    On branch main
    Your branch is up to date with 'origin/main'.

    Changes not staged for commit:
      (use "git add <file>..." to update what will be committed)
      (use "git restore <file>..." to discard changes in working directory)
            modified:   CA1/spring-framework-petclinic/readme.md
            modified:   CA1/spring-framework-petclinic/src/main/java/org/springframework/samples/petclinic/model/Vet.java
            modified:   CA1/spring-framework-petclinic/src/main/resources/db/h2/data.sql
            modified:   CA1/spring-framework-petclinic/src/main/resources/db/h2/schema.sql
            modified:   CA1/spring-framework-petclinic/src/main/webapp/WEB-INF/jsp/vets/vetList.jsp

    no changes added to commit (use "git add" and/or "git commit -a")
    nacunha@cogsi:/mnt/hgfs/Shared/cogsi2526-1240444-1211426-1211689$

Excerto do *output* do comando **git diff**:

    diff --git a/CA1/spring-framework-petclinic/src/main/resources/db/h2/data.sql b/CA1/spring-framework-petclinic/src/main/resources/db/h2/data.sql
    index f232b13..0f23e2e 100644
    --- a/CA1/spring-framework-petclinic/src/main/resources/db/h2/data.sql
    +++ b/CA1/spring-framework-petclinic/src/main/resources/db/h2/data.sql
    @@ -1,9 +1,9 @@
    -INSERT INTO vets VALUES (default, 'James', 'Carter');
    -INSERT INTO vets VALUES (default, 'Helen', 'Leary');
    -INSERT INTO vets VALUES (default, 'Linda', 'Douglas');
    -INSERT INTO vets VALUES (default, 'Rafael', 'Ortega');
    -INSERT INTO vets VALUES (default, 'Henry', 'Stevens');
    -INSERT INTO vets VALUES (default, 'Sharon', 'Jenkins');
    +INSERT INTO vets VALUES (default, 'James', 'Carter','1');
    +INSERT INTO vets VALUES (default, 'Helen', 'Leary','2');
    +INSERT INTO vets VALUES (default, 'Linda', 'Douglas','3');
    +INSERT INTO vets VALUES (default, 'Rafael', 'Ortega','4');
    +INSERT INTO vets VALUES (default, 'Henry', 'Stevens','5');
    +INSERT INTO vets VALUES (default, 'Sharon', 'Jenkins','6');
 

#### 3.2.  Fazer **staging** das alterações

Utilizando o comando **git commit -A** fazemos *staging* de todos os ficheiros alterados. Podemos ver o efeito do comando correndo novamente o comando **git status**.

    nacunha@cogsi:/mnt/hgfs/Shared/cogsi2526-1240444-1211426-1211689$ git status
    On branch main
    Your branch is up to date with 'origin/main'.

    Changes to be committed:
      (use "git restore --staged <file>..." to unstage)
            modified:   CA1/spring-framework-petclinic/readme.md
            modified:   CA1/spring-framework-petclinic/src/main/java/org/springframework/samples/petclinic/model/Vet.java
            modified:   CA1/spring-framework-petclinic/src/main/resources/db/h2/data.sql
            modified:   CA1/spring-framework-petclinic/src/main/resources/db/h2/schema.sql
            modified:   CA1/spring-framework-petclinic/src/main/webapp/WEB-INF/jsp/vets/vetList.jsp

    nacunha@cogsi:/mnt/hgfs/Shared/cogsi2526-1240444-1211426-1211689$ 

Pode-se observar que os ficheiros que, anteriormente, foram alterados estão *staged* e prontos para *commit*.

#### 3.2. Fazer **commit** das alterações

Para se fazer o *commit* das alterações utiliza-se comando **git commit**. Adicionalmente, foi utilizada a *flag* **-m** para que uma mensagem informativa seja adicionada.

    nacunha@cogsi:/mnt/hgfs/Shared/cogsi2526-1240444-1211426-1211689$ git commit -m "Issue 2: Implementação feita e dados de teste adicionados"
    [main aae60b1] Issue 2: Implementação feita e dados de teste adicionados
     5 files changed, 37 insertions(+), 242 deletions(-)
    nacunha@cogsi:/mnt/hgfs/Shared/cogsi2526-1240444-1211426-1211689$ 

Dado que estamos a trabalhar com um repositório remoto é necessário correr o comando **git push origin main** para enviar a versão com as alterações feitas.

    nacunha@cogsi:/mnt/hgfs/Shared/cogsi2526-1240444-1211426-1211689$ git push origin main
    Enumerating objects: 47, done.
    Counting objects: 100% (47/47), done.
    Delta compression using up to 2 threads
    Compressing objects: 100% (19/19), done.
    Writing objects: 100% (24/24), 2.23 KiB | 127.00 KiB/s, done.
    Total 24 (delta 9), reused 0 (delta 0), pack-reused 0
    remote: Resolving deltas: 100% (9/9), completed with 9 local objects.
    To github.com:davidsferreira02/cogsi2526-1240444-1211426-1211689.git
       eeef565..aae60b1  main -> main

### 4º Passo - Verificações

Para verificar as mudanças é necessário correr o comando **./mvnw -DskipTests jetty:run-war** e, de seguida, aceder à pagina *web* e verificar se na aba dos veterinários as mudanças são visíveis.

![Validação da implementação](/CA1\spring-framework-petclinic\img\licenseNumberFeature\Issue2ValidacaoImplementacao.png "Issue 2")

Como podemos ver, o campo foi adicionado com sucesso à tabela dos veterinários.